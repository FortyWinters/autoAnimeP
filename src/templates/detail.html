{% extends "base.html" %}

{% block title %}{{ anime.anime_name }}{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/detail.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/anime.css') }}">
    <script src="{{ url_for('static', filename='jquery/jquery.3.7.1.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/anime.js') }}"></script>
    <script src="{{ url_for('static', filename='js/detail.js') }}"></script>
{% endblock %}

{% block body %}
<div>
    <div class="anime-info-container">
        <div class="anime-img">
            <img src="{{ url_for('static', filename='img/anime_list/'+anime.img_url.split('/')[4]) }}" alt="" height="280px" width="210px">
        </div>
        <div class="anime-info">
            <div class="anime-name">
                {{ anime.anime_name }}
            </div>
            <div class="button-container">
                {% if anime.subscribe_status==1 %}
                    <button class="subscribe-button" id="{{ anime.mikan_id }}" subscribe_status="{{ anime.subscribe_status }}" style="background-color:red;">
                        <img src="{{ url_for('static', filename='img/icon/subscribe.svg') }}" alt="" width="20px" height="20px">
                    </button>
                    <button class="update-button" id="{{ anime.mikan_id }}">
                        <img src="{{ url_for('static', filename='img/icon/update.svg') }}" alt="" width="20px" height="20px">
                    </button>
                    <button class="download-button" id="{{ anime.mikan_id }}" subscribe_status="{{ anime.subscribe_status }}" style="background-color:orange;">
                        <img src="{{ url_for('static', filename='img/icon/download.svg') }}" alt="" width="20px" height="20px">
                    </button>
                    <button class="clean-button" id="{{ anime.mikan_id }}">
                        <img src="{{ url_for('static', filename='img/icon/clean.svg') }}" alt="" width="20px" height="20px">
                    </button>
                {% else %}
                    <button class="subscribe-button" id="{{ anime.mikan_id }}" subscribe_status="{{ anime.subscribe_status }}">
                        <img src="{{ url_for('static', filename='img/icon/subscribe.svg') }}" alt="" width="20px" height="20px">
                    </button>
                    <button class="update-button" id="{{ anime.mikan_id }}">
                        <img src="{{ url_for('static', filename='img/icon/update.svg') }}" alt="" width="20px" height="20px">
                    </button>
                    <button class="clean-button" id="{{ anime.mikan_id }}">
                        <img src="{{ url_for('static', filename='img/icon/clean.svg') }}" alt="" width="20px" height="20px">
                    </button>
                {% endif %}   
            </div>
            <div class="episode-container">
                {% for item in sorted_episode_list %}
                    {% for episode, status in item.items() %}
                        {% if status == 1 %}
                            <div class="episode" style="background-color:rgb(41, 207, 132);">{{ episode }}</div>
                        {% elif status == 0 %}
                            <a href="/download">
                                <div class="episode" style="background-color:rgb(88, 202, 255);">{{ episode }}</div>
                            </a>
                        {% else %}
                            <div class="episode" onclick="downloadSingleEpisode('{{ anime.mikan_id }}', '{{ episode }}')">{{ episode }}</div>
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}